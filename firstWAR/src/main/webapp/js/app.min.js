function openAttachment(b,e,c,a){var d=cwc.getValueFromCurrentTab("threadId");window.open("detail.do?ctx=attachment&action=open&name="+encodeURIComponent(b)+"&id="+e+"&type="+c+"&len="+a+"&thread="+d,"openAttachment")}function openAddedAttachment(a){window.open("detail.do?ctx=attachment&action=openadded&filepath="+encodeURIComponent(a),"openAttachment")}function selectAttachment(b){var a=document.getElementById("hidden_attachments_div");if(!a){a=document.createElement("input");a.type="hidden";a.id="hidden_attachments_div";a.name="hidden_attachments_div";document.forms[scFromDefault].appendChild(a)}a.value=b;window.open("selectFile.jsp?action=attachmentupload","AttachmentSelector","height=100, width=400")}function deleteRow(a){if(document.getElementById(a)){document.getElementById(a).style.display="none"}}function onDeleteAttachment(e){var f=e.substring(4);var d=document.getElementById("hidden_"+e);var a=parseInt(document.getElementById("len_"+f).value);var c=document.getElementById("type_"+f);var b=document.getElementById("file_"+f);if(c!=null){d.value=f+"?"+a+"?"+c.value+"?"+b.value}else{d.value=e}setAttachmentListSize(getAttachmentListSize()-a);lockForm()}function onCancelUpload(){window.close()}function onAttachmentUploaded(d,b,a){if(b!=null&&b!=""){window.opener.createAttachment(d,b,parseInt(a));var c=window.opener.document.forms.topaz.hidden_attachments_div.value;window.opener.document.getElementById(c+"attachments_scroll").style.display="inline";if(window.opener.document.getElementById("xxx")){window.opener.document.getElementById("xxx").value=window.opener.document.getElementById(c+"attachement_cont").innerHTML}}window.close()}function createAttachment(g,e,u){if(checkSize(u)==false){return}lockForm();var v=getAttachmentList();var i=v.tBodies[0];var b=i.insertRow(-1);var f="TableOddRow";if(v.length%2){f="TableEvenRow"}b.className=f;b.id=g;var p=b.insertCell(-1);var l=document.createElement("input");l.type="hidden";l.id="hidden_del_new_"+g;l.name="attachmentsDeleted/attachment_"+g;p.appendChild(l);var k=document.createElement("input");k.type="hidden";k.id="hidden_new_"+g;k.name="attachmentsAdded/attachment_"+g;k.value=g+"?"+e;p.appendChild(k);var j=document.createElement("input");j.type="hidden";j.id="len_new_"+g;j.name="len_new_"+g;j.value=u;p.appendChild(j);var x=document.createElement("a");var s=document.createElement("span");var a=Math.max(e.lastIndexOf("/"),e.lastIndexOf("\\"));var t=e.substring(a+1);var d=(window.opener&&window.opener.viewAttachment508)?window.opener.viewAttachment508:self.viewAttachment508;if(!isIE){e=encodeURIComponent(e)}x.href="javascript:openAddedAttachment('"+e.replace(/\'/gi,"\\'")+"')";x.title=d;s.innerHTML=t;x.appendChild(s);p.appendChild(x);var o=b.insertCell(-1);var n=u+" bytes";o.innerHTML=n;var m=b.insertCell(-1);m.className="ColRemove";var h=document.createElement("input");h.type="hidden";h.id="del_new_"+g;h.name="len_new_"+g;h.value="true";m.appendChild(h);var w=document.createElement("a");var c=(window.opener&&window.opener.removeAttachment508)?window.opener.removeAttachment508:self.removeAttachment508;w.href="javascript:deleteRow('"+g+"');onDeleteAttachment('del_new_"+g+"')";w.title=c;var q=document.createElement("span");var r=(window.opener&&window.opener.removeAttachment)?window.opener.removeAttachment:self.removeAttachment;q.innerHTML=r;w.appendChild(q);m.appendChild(w)}function getDate(){var a=new Date();return a.getMonth()+1+"/"+a.getDate()+"/"+a.getFullYear()}function getAttachmentList(){var a=document.forms[scFromDefault].hidden_attachments_div.value;return document.getElementById(a+"attachments_list")}function getMaxAttachSize(){var a=getAttachmentList();return parseInt(a.getAttribute("maxAttachSize"))}function setMaxAttachSize(b){var a=getAttachmentList();a.setAttribute("maxAttachSize",b)}function getTotalAttachSize(){var a=getAttachmentList();return parseInt(a.getAttribute("totalAttachSize"))}function setTotalAttachSize(b){var a=getAttachmentList();return a.setAttribute("totalAttachSize",b)}function getAttachmentListSize(){var a=getAttachmentList();return parseInt(a.getAttribute("size"))}function setAttachmentListSize(b){var a=getAttachmentList();return a.setAttribute("size",b)}function checkSize(b){var a=getAttachmentListSize()+b;var d=getMaxAttachSize();if(d<=0){d=b}var c=getTotalAttachSize();if(c<=0){c=a}if(b>d){alert(maxAttachSizeExceedMsg);return false}else{if(a>c){alert(totalAttachmentSizeExceedMsg);return false}else{setAttachmentListSize(a);return true}}}function dvdUpdateMaxAttachSize(a,b){iValue=parseInt(b);if(isNaN(iValue)){return}setMaxAttachSize(iValue)}function dvdUpdateTotalAttachSize(a,b){iValue=parseInt(b);if(isNaN(iValue)){return}setTotalAttachSize(iValue)}var prefix="FileSelector_";function chooseUnique(a){window.open("selectFile.jsp?action=uniqueupload",prefix+a,"height=100, width=400")}function privRemoveUnique(b){var d=document.getElementById(b+"Deleted");var c=document.getElementById(b+"DeletedValue");if(d&&c){d.value=c.value}var a=document.getElementById(b+"Added");if(a){a.value="none_added"}}function removeUnique(b){privRemoveUnique(b);var a=document.getElementById(b+"Properties");a.innerHTML="";a.style.display="none";var c=document.getElementById(b+"Add");c.disabled=false;var d=document.getElementById(b+"Remove");d.disabled=true}function onUniqueUploaded(d,e,c,a){var b=window.name.substring(prefix.length);window.opener.updateUnique(b,d,e,c,a);window.close()}function updateUnique(f,e,i,b,g){privRemoveUnique(f);var d=document.getElementById(f+"Added");if(d){d.value=e+"?"+i}var a=document.getElementById(f+"Properties");if(!isIE){i=encodeURIComponent(i)}a.href="javascript:openAddedAttachment('"+i.replace(/\'/gi,"\\'")+"')";a.innerHTML=b+" ("+g+" bytes)";a.style.display="inline";var h=document.getElementById(f+"Add");h.disabled=true;var c=document.getElementById(f+"Remove");c.disabled=false}hpsm.clpsSections=function(){var m={};function n(u){var r=u.children;var t=0;for(var q=0,p=r.length;q<p;q++){var w=r[q];var v=0;var s=tpzGetStyle(w,"position");if(s!="absolute"&&s!="relative"){v=n(w)}else{if(w.offsetTop||w.offsetHeight){v=w.offsetTop+w.offsetHeight}}if(v>t){t=v}}return t}function j(p){cwc.removeStyleClass(p.btn.firstChild,"toggleClose");p.btn.setAttribute("alt",p.btn.getAttribute("expandhint"));p.btn.setAttribute("title",p.btn.getAttribute("expandhint"));cwc.addStyleClass(p.fieldset,"cntHidden");p.panel.style.height="24px";c(p);g()}function g(){if(!top.cwc.isIE){return}var p=(top.cwc.isListDetail())?top.cwc.getDetailFrameDocument():top.cwc.getCenterFrameDoc();var q=p.msgBox;if(q&&q.getY()!=q.yOffset){p.msgBox.setY(q.yOffset,false)}}function l(q){cwc.addStyleClass(q.btn.firstChild,"toggleClose");q.btn.setAttribute("alt",q.btn.getAttribute("collapsehint"));q.btn.setAttribute("title",q.btn.getAttribute("collapsehint"));cwc.removeStyleClass(q.fieldset,"cntHidden");if(cwc.getTopCwc().isIE){q.fieldset.style.display="block"}hpsm.lazyloadViewer(q.fieldset);h(q);c(q);if(q.lazyExpSecs){for(var p=0;p<q.lazyExpSecs.length;p++){l(q.lazyExpSecs[p])}delete q.lazyExpSecs}}function k(t){var q=document.getElementById(t);if(q.section!=null){return q.section}else{var p=document.getElementById(t+"Container");var s;if(p!=null){s=p.getAttribute("default-height")||0}var r={panel:q,fieldset:p,btn:document.getElementById(t+"Toggle"),defaultHeight:parseInt(s),isExpanded:function(){return !a(this.fieldset,"cntHidden")},getParentSection:function(){if(this.parentSection==undefined){var u=e(r.panel);if(u==null){return null}this.parentSection=k(u.id)}return this.parentSection},addPendingExpandChild:function(u){if(this.lazyExpSecs==undefined){this.lazyExpSecs=[]}this.lazyExpSecs.push(u)}};q.section=r;return r}}function e(q){var p=q.parentNode;if(p==null){return null}if(p.className=="sm-clpsSection"){return p}return e(p)}function a(s,q){var p=s.className.split(" ");for(var r=p.length;r>0;){if(p[--r]==q){return true}}return false}function i(q){var p=k(q);if(p.isExpanded()){j(p)}else{l(p)}o.saveState(q,p.isExpanded())}function c(q){if(isPreview){return}var p=q.getParentSection();if(p==null){return}h(p,true);c(p)}function h(t,s){if(t.isExpanded()){var p;if(isPreview){p=t.defaultHeight}else{if(s||t.contentHeight==undefined){p=b(t)}else{p=t.contentHeight}}var r=t.fieldset.style.height;var q=t.panel.style.height;r=parseInt(r);q=parseInt(q);if((isNaN(r))||(p>r)){t.fieldset.style.height=p+"px"}if((isNaN(q))||((p+15)>q)){t.panel.style.height=(p+15)+"px"}}}function b(q){var p=n(q.fieldset);if(p==0){p=q.defaultHeight}else{q.contentHeight=p;p+=20}return p}var f="groupCache";var o={getCachedObj:function(){var q=cwc.getValueFromCurrentTab(f);if(!q){q={};var p={};p[f]=q;cwc.storeValuesInCurrentTab(p)}return q},cleanCache:function(q){var p={};p[f]=null;cwc.storeValuesInTab(q,p)},genCacheKey:function(p){return hpsm.sCurrentForm+"_"+p},loadState:function(p){return this.getCachedObj()[this.genCacheKey(p)]},saveState:function(q,p){this.getCachedObj()[this.genCacheKey(q)]=p}};function d(){for(sectionId in m){var p=o.loadState(sectionId);if(p===false||p==null&&!m[sectionId]){continue}var r=k(sectionId);var q=r.getParentSection();if(q!=null&&!q.isExpanded()){q.addPendingExpandChild(r);continue}l(r)}m=null}return{reg:function(q,p){m[q]=p},init:function(){d()},toggleSection:function(p,q){i(q);p.focus()},btnkeydownHandler:function(r){var p=getKey(r);if(p==13){var q=getTarget(r);var s=q.id.replace("Toggle","");i(s)}if(r.stopPropagation){r.stopPropagation()}r.cancelBubble=true;if(r.preventDefault){r.preventDefault()}r.returnValue=false},cleanCache:function(p){o.cleanCache(p)},getSectionObj:function(p){return k(p)},expandSection:function(p){l(p)}}}();Ext.namespace("hpsm");hpsm.JSON_TAG_IMG="___img:";hpsm.BASE_IMAGES_PATH="images/obj16/";(function(){hpsm.initColumnRenderer=function(b){for(var c=0,a=b.config.length;c<a;c++){var d=b.config[c];if(d.id!="checker"){b.setRenderer(c,hpsm._renderColumn)}}};hpsm._renderColumn=function(c){if(c&&typeof(c)=="string"){var a=c.indexOf(hpsm.JSON_TAG_IMG);if(a!=-1){c=c.substring(hpsm.JSON_TAG_IMG.length);if(c.indexOf(".gif")==-1){c=c+".gif"}var b=hpsm.BASE_IMAGES_PATH+c;c="<img src="+b+">"}}if(listConfig.displayMode=="list"&&this.isFirstColumn=="true"){if(!c||c.trim()==""){return'<a tabIndex="-1" onclick="return false;" href="javascript:void(0);">'+hpsm.l10n.reclist.column_detail+"</a>"}else{return'<a tabIndex="-1" onclick="return false;" href="javascript:void(0);">'+c+"</a>"}}return c}})();Ext.namespace("hpsm");hpsm.GRID_COLUMNS_WIDTH_RECORD="columns_width";(function(){var g;var f;var d=2;hpsm.resetColumnWidth=function(i,l){var k=hpsm.ux.GridUtil.getStorageItem();a(i,l);if(k&&k[hpsm.GRID_COLUMNS_WIDTH_RECORD]){e(i,k[hpsm.GRID_COLUMNS_WIDTH_RECORD])}var j=hpsm.local.recordsList;if(j){g=j.getColumnModel().getTotalWidth()+d;f=j.getView().getGridInnerWidth(true)}};function e(l,m){for(var k in m){var i=m[k];var j=l.findColumnIndex(k);if(j!=-1){l.setColumnWidth(j,i);h(j,i)}}}function a(i,j){c(i,j,false)}function c(s,j,o){var n=0;var k=0;var p=s.getTotalWidth(true);for(var m=0,r=s.config.length;m<r;m++){var q=s.config[m];if(q.id=="checker"){s.setColumnWidth(m,q.width);p-=q.width;j-=q.width;continue}if(!q.widthPercent||q.widthPercent==""||isNaN(q.widthPercent)){q.widthPercent=1/r*100}var l=0;if(m==r-1){if(k>100&&!o){l=Math.round(j*q.widthPercent/100)}else{l=j-n-d;l=l>0?l:50}}else{if(o){l=Math.round(j*q.width/p);n+=l}else{l=Math.round(j*q.widthPercent/100);n+=l;k+=Math.round(q.widthPercent)}}s.setColumnWidth(m,l)}}hpsm.resizeColumn=function(k,i){b(this.getColumnModel(),k,i);h(k,i);var j=hpsm.local.recordsList;g=j.getColumnModel().getTotalWidth()+d;j.getView().refresh(false)};function h(l,i){var j=hpsm.local.recordsList;var k=j.getColumnModel().config[l];var m=j.getView().getGridInnerWidth(true);k.widthPercent=i/m*100}function b(j,l,i){var k=j.getDataIndex(l);var m=hpsm.ux.GridUtil.getStorageItem();var n={};if(m){Ext.apply(n,m)}if(!n[hpsm.GRID_COLUMNS_WIDTH_RECORD]){n[hpsm.GRID_COLUMNS_WIDTH_RECORD]={}}n[hpsm.GRID_COLUMNS_WIDTH_RECORD][k]=i;hpsm.ux.GridUtil.saveStorageItem(n)}hpsm.autoResizeColumns=function(){var l=hpsm.local.recordsList;var m=l.getColumnModel();var k=m.getTotalWidth()+d;var j=l.getView().getGridInnerWidth(true);var n=j-f;f=j;var i=k;if(n>0){if(j>k){i=j}}else{if(n<0){if(j>=k){}else{if(j>=g){i=j}else{i=g}}}}if(i!=k){c(m,i,true);l.getView().refresh(false)}}})();